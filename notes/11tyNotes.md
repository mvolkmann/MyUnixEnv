# 11ty Notes

## Static site generators (SSGs)

SSGs are an alternative to CMS tools (like WordPress and Drupal)
and graphical site builders (like Squarespace and Wix).

The primary benefits of SSGs are:

- Static sites provide excellent runtime performance.
- Static sites are more secure because all API interactions
  occur during site generation, not when users interact with the site.
  This means there is less of a chance that server hacking
  can affect the content of a site.
- The supported markup/templating options are typically
  easier to write and understand than HTML.
- Development of an SSG site can start from
  a pre-built site to speed development.

See [staticgen.com](https://www.staticgen.com/) for a list
of SSGs that can be sorted on various criteria.

Key differentiators between SSGs include:

- supported template languages (Angular, EJS, Go, Haml,
  Handlebars, HTML, JavaScript, Liquid, Markdown, Marko,
  Mustache, Nunjucks, Pug, React, Swig, Twig, Vue, ...)
- the implementation language (Go, JavaScript, PHP, Python, Ruby, ...)
  which affects your ability to customize the software
- ability to configure the SSG to use
  existing content files and directory structures
- license (Apache-2.0, Jinja2, MIT, ...)

## 11ty overview

11ty is "a simple static style generator" (SSG).
It is targeted at building static "sites", not web "apps".
11ty is mostly written and maintained by Zach Leatherman.
It is implemented in JavaScript.

The 11ty mascot is a possum attached to a helium balloon.

11ty is the most popular SSG that supports multiple template languages.

A lot of big names in the web community love 11ty, including
Mathias Bynens, Chris Coyier, Brian Leroux, Addy Osmani, Sara Soueidan
See https://www.11ty.dev/docs/testimonials/.

11ty competes with:

- Gatsby (React)
- Hugo (Go)
- Jekyll (Ruby)
- Next (React)
- Nuxt (Vue)
- Sapper (Svelte)
- and more

11ty supports many templating languages (11) including:

- Embedded JavaScript (EJS) in .ejs files
- Haml in .haml files
- Handlebars in .hbs files
- HTML in .html files
- JavaScript in .11ty.js files
- JavaScript Template Literals in .jstl files
- Liquid in .liquid files
- Markdown in .md files
- Mustache in .mustache files
- Nunjucks in .njk files (by Mozilla)
- Pug in .pug files

It does not currently support AsciiDoc.

An 11ty site can be built from source files
that use a combination of templating languages.

An 11ty project can be configured to work with
existing content files and an existing directory structure.
It looks for template files in all project directories
and outputs `.html` files in the `_site` directory (by default)
with the same directory structure.

The build process requires Node, but sites generated by 11ty
do not require downloading any JavaScript code.
Serving only prebuilt pages provides great site performance.
JavaScript code can optionally be included for dynamic functionality.

## Resources

See the project home page at [11ty.dev](http://11ty.dev).

A great tutorial video by Kyle Mitofsky can be found at
https://www.youtube.com/watch?v=ozTesGh0l74

See the video series from Brian Robinson at his
[blog](https://bryanlrobinson.com/blog/create-11ty-theme-from-static-html-template/).

See Khaled Garbaya's video series on [Egghead](https://egghead.io/lessons/11ty-bootstrap-an-eleventy-project?pl=getting-started-with-eleventy-53c2).

## Starter Themes

There are many free and commercial themes
that can be used as starting points and customized.
Google for "free Bootstrap theme" or "free HTML template".
Search sites like [ThemeForest](https://themeforest.net/),
[ThemeHunt](https://themehunt.com/),
and [ThemeHut](https://themehut.blogspot.com/).
One example is [Flat Theme Lite](https://themehunt.com/item/1524965-flat-theme-lite-free-responsive-multipurpose-site-template).

## Steps to create an 11ty site

This example uses Markdown and Nunjucks.

1. Create project directory.
1. Enter `npm init`.
1. Enter `npm i @11ty/eleventy`.
1. Create an `index.md` file.

   ```md
   # Mark Volkmann's Blog
   ```

1. Create an `about.md` file.

   ```md
   # About Mark Volkmann

   Mark is a software engineer at Object Computing, Inc. in St. Louis, Missouri.
   ```

1. Optionally build the site by entering `npx eleventy`.
   This creates a `_site` directory containing HTML files.
   `index.md` -> `index.html`
   `about.md` -> `about/index.html`

1. Build and serve the site locally
   with hot reloading using BrowserSync by entering
   `npx eleventy --serve`.

1. Browse localhost:8080 and localhost:8080/about.

If the project is placed in a Git repository,
add `_site/` to the `.gitignore` file
since that only contains generated code.

Optionally add these npm scripts in `package.json`
that can be used to build and serve the site:

```json
"build": "eleventy",
"start": "eleventy --serve"
```

## Deploying 11ty sites

An 11ty site can be published to a server
by copying the contents of the `_site` directory
to the server.

A service like Netlify or Zeit NOW can be used
to associate a site repository so
the site is rebuilt and deployed on every push.

TODO: Show the steps to deploy an 11ty site to GitHub Pages which is free.
TODO: Consider converting your website to do this.

## Front matter

Files processed by 11ty can begin with YAML front matter.
This begins with a line containing only three dashes
and ends with the same kind of line.
Lines between these define variables.
For example:

```yaml
---
layout: layout.njk
title: Dogs
---

```

Variables can be used other files and can represent many kinds of values
including CSS property values, icons, URLs, ...

Some special variables recognized by 11ty include:

- layout:
  uses a layout template found in the `_includes` directory
- tags:
  single string or array of collection names to which this data belongs
- date: overrides the default file creation date to change sort order
- pagination:
  enables iteration over data in front matter to
  output multiple HTML files from this template
- permalink:
  changes the output target of the template
- dynamicPermalink:
  enables or disables template syntax in permalink
- templateEngineOverride:
  overrides the template engine used for this file
- eleventyExcludeFromCollections:
  true to exclude this content from collections

TODO: Are there any Nunjucks-specific variables?

## Layouts

To define layouts that are used for multiple pages:

1. Create a `_includes` directory to hold configuration files
   for layouts and more.

1. Create the file `layout.njk` in this directory.
   This uses the Nunjucks templating language, but others can be used.
   The Nunjucks library does not need to be installed.
   For details on Nunjucks syntax, see
   [Nunjucks Templating](https://mozilla.github.io/nunjucks/templating.html)
   It's a pretty extensive language!

   ```njk
   <!DOCTYPE html>
   <html lang="en">
   <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{title}}</title>
    <link rel="stylesheet" href="/assets/styles.css" />
   </head>
   <body>
    <h1>Mark Volkmann's Blog</h1>
    <nav> <!-- for page navigation -->
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
      </ul>
    </nav>
    <h2>{{title}}</h2>
    <!-- content is where page content is injected -->
    <!-- safe causes the HTML content to be sanitized -->
    {{content | safe}}
   </body>
   </html>
   ```

1. Add the following "front matter" to the beginning of each content file:

   ```yaml
   ---
   layout: layout.njk
   title: {the page title}
   ---

   ```

   Any number of pages can use the same layout file
   and a site can use any number of layout files.

   `title` is like a variable that can be used in the layout.

A layout can extend another layout.
What does this mean?

## Styling

1. Create an `assets` directory.
   The name isn't significant.

1. Create the file `styles.css` inside it
   with content like the following:

   ```css
   nav {
     background-color: cornflowerblue;
     color: white;
   }

   li {
     margin-right: 1rem;
   }

   ul {
     display: flex;
     list-style: none;
     padding: 0.5rem;
   }
   ```

1. Create a `.eleventy.js` file at the top of the project with the following content:

```js
module.exports = function(eleventyConfig) {
  // This causses the build process to
  // copy the assets directory to _site.
  eleventyConfig.addPassthroughCopy('assets');
};
```

TODO: Is there a way to scope css to a page?

## Collections

Collections of data are defined by specifying tags in front matter.
For example, documents that each describe a specific dog
can have the following `tags: dog` in their front matter.

```yaml
tags: dog,
name: dasher,
breed: whippet
```

Multiple tags can be specified by listing them
in square brackets separated by commas.
For example, `tags: ['dog', 'pet']`.
TODO: are the single quotes required here?

Other nunjucks documents can access a collection using a `for` loop.
for example:

```js
{%- for dog in collections.dog -%}
  <p>{{ dog.data.name}} is a {{dog.data.breed}}.</p>
{%- endfor -%}
```

Note the use of `.data` to access the variables specified for a dog.

A layout can specify tags that become the default tags
for all pages that use the layout.
These can be overridden by specifying a different value for `tags` in a page.

For more information on 11ty collections,
see [collections](https://www.11ty.dev/docs/collections/).

## Collection sorting

Collections are sorted on the creation date of their documents.
To iterate over a collection in a different order,
add code in `.eleventy.js` that adds
a new collection that is sorted in the desired way.

For example:

```js
eleventyConfig.addCollection('dogsByName', collection => {
  // Get only the documents that have a tag of "dog".
  const dogs = collection.getFilteredByTag('dog');
  // Sort the dogs on their name.
  dogs.sort((dog1, dog2) => dog1.data.name.localeCompare(dog2.data.name));
  return dogs;
});
```

Use the collection `dogsByName` in a `for` loop
to iterate in the new sorted order.

## Shortcodes

Shortcodes define snippets of reusable content.
For example, here is a "dog" shortcode definition
that is define in `.eleventy.js`.

```js
eleventyConfig.addShortcode(
  'dog',
  (breed, name) => `
    <div class="dog">
      <div class="name">Name: ${name}</div>
      <div class="breed">Breed: ${breed}</div>
    </div>
  `
);
```

This definition becomes globally available.
To use it:

```njk
{%- for dog in collections.dogsByName -%}
  {% dog dog.data.breed, dog.data.name %}
{%- endfor -%}
```

## Components

Are shortcodes the closest thing to components in 11ty?

## Global data

Global data can be defined in `.js` or `.json` files in the `_data` directory.
When defined in a `.js` file, it should export a function that returns the data.
For example, the file `_data/hockey.js` could contain:

```js
module.exports = () => [
  {city: 'Chicago', name: 'Blackhawks'},
  {city: 'St. Louis', name: 'Blues'}
];
```

TODO: Can the JavaScript code call a REST service to get the data?

To render this data in a template:

```njk
{%- for team in hockey -%}
  <p>The {{team.name}} play in {{team.city}}.</p>
{%- endfor -%}
```

## 11ty configuration

todo: cover details of the .eleventy.js file.

## Nunjucks configuration

TODO: Cover any nunjucks-specific configuration.

## CMS integration

TODO: How can an 11ty site use assets from a CMS like Strapi?

## Obtaining data from REST services

TODO: Add this.

## Plugins

The functionality of 11ty can be extended with plugins.
These are documented [here](https://www.11ty.dev/docs/plugins/).

### Syntax highlighting

Install the plugin.

```bash
npm install -D @11ty/eleventy-plugin-syntaxhighlight
```

Modify .eleventy.js:

```js
const syntaxHighlight = require('@11ty/eleventy-plugin-syntaxhighlight');
module.exports = eleventyConfig => {
  ...
  eleventyConfig.addPlugin(syntaxHighlight);
};
```

Download a Prism theme `.css` file from
[Prism themes](https://github.com/PrismJS/prism-themes)
and place it in the `assets` directory.
For example, `prism-vs.css`.

Add a `link` tag for this in all layout files whose pages need it.
For example, this can be added in `_includes/layout.njk`.

```html
<link rel="stylesheet" href="/assets/prism-vs.css" />
```

Surround code to have syntax highlighting with fences.
For example:

````text
 ```js
 code goes here
 ```
````

For more details, see the documentation [here](https://www.11ty.dev/docs/plugins/syntaxhighlight/).

### Internationalization

TODO: See https://www.webstoemp.com/blog/multilingual-sites-eleventy/.

```

```
